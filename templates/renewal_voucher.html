{% extends "dashboard.html" %}
{% block content %}
<div class="rv-container">
    <div class="rv-header">Renewal Voucher</div>
    <form method="get" class="rv-search-row">
        <label for="office">Select Office:</label>
        <select name="office" id="office">
            <option value="">Select office</option>
            {% for office in offices %}
                <option value="{{ office.office_name }}" {% if selected_office == office.office_name %}selected{% endif %}>{{ office.office_name }}</option>
            {% endfor %}
        </select>
        <button type="submit">Search</button>
    </form>
    <div class="rv-table-container">
        <table class="rv-table">
            <thead>
                <tr>
                    <th>SL No.</th>
                    <th>Item Name &amp; Description</th>
                    <th>Head</th>
                    <th>L/P No.</th>
                    <th>Qty Issue</th>
                    <th>Issue Date</th>
                    <th>Remark</th>
                </tr>
            </thead>
            <tbody>
                {% if vouchers %}
                    {% for v in vouchers %}
                        <tr>
                            <td>{{ loop.index }}</td>
                            <td>{{ v.item_name }}</td>
                            <td>{{ v.head or '' }}</td>
                            <td>{{ v.lp_no or '' }}</td>
                            <td>{{ v.quantity }}</td>
                            <td>{{ v.date }}</td>
                            <td>{{ v.remarks or '' }}</td>
                        </tr>
                    {% endfor %}
                {% else %}
                    <tr>
                        <td colspan="7" style="text-align:center;">No data available</td>
                    </tr>
                {% endif %}
            </tbody>
        </table>
    </div>
    <div class="rv-actions">
        <a class="pdf-btn" href="{{ url_for('export_renewal_voucher_pdf', office=selected_office) }}">Export to PDF</a>
        <a class="excel-btn" href="{{ url_for('export_renewal_voucher_excel', office=selected_office) }}">Export to Excel</a>
        <a href="{{ url_for('dashboard') }}" class="back-btn">Back</a>
    </div>
</div>
{% endblock %}
        .rv-search-row button:hover {
            background: #0056b3;
        }
        .rv-table-container {
            background: #fff;
            border-radius: 4px;
            margin: 0 8px;
            padding: 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }
        table.rv-table {
            width: 100%;
            border-collapse: collapse;
            margin: 0;
            font-size: 1.08em;
        }
        table.rv-table th, table.rv-table td {
            border: 1px solid #bbb;
            padding: 10px 8px;
            text-align: left;
        }
        table.rv-table th {
            background: #f5f5f5;
            font-weight: bold;
            font-size: 1.08em;
        }
        .rv-actions {
            display: flex;
            justify-content: center;
            gap: 18px;
            margin: 32px 0 18px 0;
        }
        .rv-actions button, .rv-actions a {
            font-size: 1.08em;
            font-weight: bold;
            border: none;
            border-radius: 6px;
            padding: 10px 28px;
            cursor: pointer;
            transition: background 0.2s;
        }
        .rv-actions .pdf-btn {
            background: #28a745;
            color: #fff;
        }
        .rv-actions .pdf-btn:hover {
            background: #218838;
        }
        .rv-actions .excel-btn {
            background: #ffc107;
            color: #222;
        }
        .rv-actions .excel-btn:hover {
            background: #e0a800;
        }
        .rv-actions .back-btn {
            background: #dc3545;
            color: #fff;
            margin-left: 24px;
        }
        .rv-actions .back-btn:hover {
            background: #b52a37;
        }
        @media (max-width: 700px) {
            .rv-search-row { flex-direction: column; gap: 10px; }
            .rv-actions { flex-direction: column; gap: 12px; }
            .rv-header { font-size: 1.3em; }
        }
    </style>
</head>
<body>
<div class="rv-container">
    <div class="rv-header">Renewal Voucher</div>
    <form method="get" class="rv-search-row">
        <label for="office">Select Office:</label>
        <select name="office" id="office">
            <option value="">Select office</option>
            {% for office in offices %}
                <option value="{{ office.office_name }}" {% if selected_office == office.office_name %}selected{% endif %}>{{ office.office_name }}</option>
            {% endfor %}
        </select>
        <button type="submit">Search</button>
    </form>
    <div class="rv-table-container">
        <table class="rv-table">
            <thead>
                <tr>
                    <th>SL No.</th>
                    <th>Item Name &amp; Description</th>
                    <th>Head</th>
                    <th>L/P No.</th>
                    <th>Qty Issue</th>
                    <th>Issue Date</th>
                    <th>Remark</th>
                </tr>
            </thead>
            <tbody>
                {% if vouchers %}
                    {% for v in vouchers %}
                        <tr>
                            <td>{{ loop.index }}</td>
                            <td>{{ v.item_name }}</td>
                            <td>{{ v.head or '' }}</td>
                            <td>{{ v.lp_no or '' }}</td>
                            <td>{{ v.quantity }}</td>
                            <td>{{ v.date }}</td>
                            <td>{{ v.remarks or '' }}</td>
                        </tr>
                    {% endfor %}
                {% else %}
                    <tr>
                        <td colspan="7" style="text-align:center;">No data available</td>
                    </tr>
                {% endif %}
            </tbody>
        </table>
    </div>
    <div class="rv-actions">
        <a class="pdf-btn" href="{{ url_for('export_renewal_voucher_pdf', office=selected_office) }}">Export to PDF</a>
        <a class="excel-btn" href="{{ url_for('export_renewal_voucher_excel', office=selected_office) }}">Export to Excel</a>
        <a href="{{ url_for('dashboard') }}" class="back-btn">Back</a>
    </div>
</div>
</body>
</html>
